{
    "collab_server" : "",
    "contents" : "\nlibrary(parallel)\n\n\ncl <- parallel::makeCluster(3)\nparallel::clusterEvalQ(cl, library(XML))\nparallel::clusterEvalQ(cl, library(httr))\nparallel::clusterEvalQ(cl, library(RCurl))\nparallel::clusterEvalQ(cl, library(magrittr)) \nttime <- Sys.time()\n\nget_html_code <- function(url){ XML::htmlParse( RCurl::getURL( url ) ,encoding = \"utf-8\" )}\n\n\nparallel::clusterEvalQ( cl,get_html_code <- function(url){ XML::htmlParse( RCurl::getURL( url ) ,encoding = \"utf-8\" )} )\n\n\n\nurl.list <- paste('https://www.ptt.cc/bbs/HomeTeach/index',c(1450:1723),'.html',sep=\"\") #for RCurl::getURL\n\net_title_url <- function (index.url){ html <- get_html_code(index.url)\n\nXML::xpathApply( html ,path = '//div[@class=\"title\"]/a[@href]', xmlAttrs ) \n\n}\n\n\nart.url <- paste( 'https://www.ptt.cc',\n                  unlist( parallel::parLapply( cl, url.list, get_title_url ))\n                  ,sep=\"\" )\n\n\nget_tdc <- function(url){ tryCatch( {\n  res  <- rep(url,4)\n  html <- get_html_code(url)\n  \n  title    <- as( XML::xpathApply( html, \n                                   path = '//span [@class=\"article-meta-value\"]',xmlValue)[[3]] ,'character' )\n  date     <- as( XML::xpathApply( html, \n                                   path = '//span [@class=\"article-meta-value\"]',xmlValue)[[4]] ,'character' )\n  contents <- as(XML::xpathApply( html, \n                                  path='//meta[@name=\"description\"][@content]')[[1]] ,'character')\n  res <- c(title,date,contents,url) }, error = function(e) {res })   \n  res  }\n\n\nsystem.time( art.xml <- parLapply( cl, art.url, get_tdc )  )\n\n\nart.data <- t( do.call( \"cbind\", parLapply(cl,art.xml, as.data.frame)))\n\narallel::stopCluster(cl)\n\n\ndim(art.data)\n\n",
    "created" : 1495509933512.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3194051559",
    "id" : "6117BF32",
    "lastKnownWriteTime" : 1495637945,
    "last_content_update" : 1495637945339,
    "path" : "C:/Users/PO HAO/Desktop/R code/ptt analysis/PTT_text-mining/web crawler.R",
    "project_path" : "web crawler.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}