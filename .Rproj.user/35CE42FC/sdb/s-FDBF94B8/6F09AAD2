{
    "collab_server" : "",
    "contents" : "#library(magrittr)\nlibrary(jiebaR)\nlibrary(wordcloud2)\n\n\nsuper_grepl <- function ( filters, rdata, excludes = NA, col ){\n  data   <- rdata[ ,col]\n  used   <- which( grepl( paste( filters, collapse = \"|\" ), x= data) ==T ) \n  \n  if ( is.na(excludes)[1] ){ data3 <- rdata[used,] } else {\n    \n    rdata2  <- rdata [used,] \n    data2   <- rdata2[ ,col]\n    exclude.data <- which( grepl( paste( excludes, collapse = \"|\" ), x= data2) ==T )\n    if( length( exclude.data )==0 ){data3 <- rdata2 } else {\n      data3  <- rdata2[-exclude.data,]  }  \n  } \n  \n  data3  }\n\n\ncc<- jiebaR:: worker() #for PC\n#cc<- jiebaR:: worker(dict=\"jieba.dict.utf8\",hmm=\"hmm_model.utf8\",user=\"user.dict.utf8\") # for shiny server \n\nsuper_jieba_cloud <- function ( rawdata, filters1, filters2, col1,  \n                                excludeword = c( 0:10,LETTERS,letters) ,\n                                output_select = 'cloud'){\n  \n  #先載入會用到的function \n  #用jieba抓filter1到filter2之間的資料並斷詞\n  jieba_segment <- function (data, begin, end){  \n    d3<-substr( data ,start = regexpr(begin,data)[1]\n                ,stop = regexpr(end,data)[1]  ) \n    jiebaR::segment(d3, cc) }\n  #刪掉rdata中有excludewords的，再輸出剩下的資料\n  excludeword_data <- function ( excludewords, rdata, col ){ data <- rdata[,col]\n  used <- which( grepl( paste( na.exclude(excludewords), collapse = \"|\" ), x= data) ==T)\n  rdata[-used,] }\n  \n  #抓符合filter1,filter2的資料\n  d1 <- super_grepl( filters = filters1, rdata = rawdata, col= col1 )\n  d2 <- super_grepl( filters = filters2, rdata = d1, col= col1 )\n  \n  # d2 <- super_grepl( filters = filters1, rdata = rawdata, col= col1 ) %>% \n  # super_grepl( filters = filters2, rdata = ., col= col1 )\n  # Shiny 的 library(magrittr) 不知道為何\n  \n  #斷詞\n  jieba.word  <- lapply( d2[,3],jieba_segment,begin = filters1, end = filters2 )\n  \n  #table好詞，並且由多到少排序\n  word.table  <- freq( unlist(jieba.word) )\n  word.table2 <- word.table[ order( word.table$freq,decreasing = T ), ]\n  \n  #刪除掉有excludeword的資料，剩下的就是我要的(畫cloud用的)\n  f.word.table <- excludeword_data( excludewords = excludeword,\n                                        rdata = word.table2,\n                                        col = 1 )\n  # 先選stop word\n  if( output_select==\"excludeword slecet\" ){  word.table2  } else \n    # 畫cloud\n    if( output_select=='cloud' ){  library(wordcloud2)\n      \n      wordcloud2::wordcloud2(data = f.word.table[1:round(nrow(f.word.table)/5,0),] )\n      \n      #輸出畫cloud用的資料\n    } else if ( output_select == 'file' ) { f.word.table }\n  \n}\n\n\n\n\n",
    "created" : 1496237858360.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "398163712",
    "id" : "6F09AAD2",
    "lastKnownWriteTime" : 1496666471,
    "last_content_update" : 1496666471989,
    "path" : "C:/Users/PO HAO/Desktop/R code/ptt analysis/PTT_text-mining/Shiny/helper.R",
    "project_path" : "Shiny/helper.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}