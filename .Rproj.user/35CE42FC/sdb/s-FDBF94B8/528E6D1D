{
    "collab_server" : "",
    "contents" : "mydata <- read.csv(\"www/articles data.csv\")\n\nsource(\"helper.R\")\n\n\nlibrary(shiny)\n#library(magrittr)\n\n\nui <- fluidPage(\n  \n  titlePanel(\"PTT家教版 文字探勘\"),\n  \n  sidebarLayout(\n    sidebarPanel(\n      \n      h4( checkboxGroupInput(\"art.type\", \"文章種類 (可複選)\",\n                              choiceNames =\n                               list(\"家教\", \"上台\" , \"交換\" ),\n                              choiceValues =\n                                list(\"家教\", \"上台\" , \"交換\" ),\n                              selected = \"家教\"\n      )),\n      h4( selectInput(\"gender.type\", \"性別\",\n                             c(\"男\" = \"boy\",\n                               \"女\" = \"girl\",\n                               \"男&女\" = \"both\"),\n                             selected = \"both\")),\n      \n      h4( selectInput(\"data.type\", \"資料類型\",\n                              c(\"科目\" = \"subject.type\",\n                                \"地點\" = \"location.type\"\n                                 ))),\n      h4( strong(\"排除關鍵字\")),\n      h4( textInput(\"exclude.1\",label = NA,value = '的')),\n      h4( textInput(\"exclude.2\",label = NA,value = '-')),\n      h4( textInput(\"exclude.3\",label = NA,value = '-')),\n      h4( textInput(\"exclude.4\",label = NA,value = '-')),\n      h4( textInput(\"exclude.5\",label = NA,value = '-')),\n      h4( textInput(\"exclude.6\",label = NA,value = \"-\"))\n      ,width = 3 ),\n    \n\n    mainPanel(\n      h4(\"此Shiny App利用R軟體抓取\"\n         ,a(href ='https://www.ptt.cc/bbs/HomeTeach/index.html',\"PTT家教版\"),\n         \"2015年5月至2017年5月發表之文章後，使用\"\n         ,a(href = 'https://github.com/qinwf/jiebaR','jueba R套件'),\n         \"對文章內容進行斷詞，並依照不同的篩選條件(文章類型、性別、常用字)，\",\n         \"以文字雲的方式呈現文章中科目欄或地點欄常出現的字詞，\",\n         \"藉以評估PTT家教版中具有較大需求的科目和地點。\"),\n      wordcloud2Output(\"f.word.cloud\",width = \"100%\", height = \"600px\"),\n      tableOutput('ddata'),\n      h4( textOutput(\"f.txt\")),\n      div( tableOutput(\"f.data\") , style = 'font-size:130%')\n      \n      ,width=9) \n  )\n)\n\n\nserver <- function(input, output) {\n  \n  gender <- reactive({  switch( as.character(input$gender.type), \"boy\" = c(\"兄\",'男','弟','哥'),\n                                                             \"girl\" = c('女','妹','姐','姊'),\n                                        'both' = c(\"兄\",'男','弟','哥','女','妹','姐','姊')) })\n  \n  #output$ddata <- renderTable({ head(super_grepl( c( input$art.type ),rdata= mydata ,col = 1))  })\n  \n  \n  #output$output<- renderText({jiebaR::segment(\"每天都要吃早餐\", cc)} )\n  #output$f.txt <- renderText(gender())\n  used.data <- reactive({ super_grepl( gender(),rdata= super_grepl( c( input$art.type ),rdata= mydata ,col = 1) \n                                       ,col = 3)  })\n  #used.data <- reactive({ super_grepl( c( input$art.type ),rdata= mydata ,col = 1) %>%\n  #                        super_grepl( gender(),rdata= . ,col = 3)  })\n  #不知道為何shiny沒辦法library(magrittr)\n  \n  data.type1<- reactive ({ switch(input$data.type, \"subject.type\"=\"科目\",'location.type'='地點')})\n  data.type2<- reactive ({ switch(input$data.type, \"subject.type\"=\"上課時間\",'location.type'='科目')})\n  \n  excludes  <- reactive ({  c(0:10,LETTERS,letters,'地點','附近',\n                             \"上\",\"科目\",'4.','的','及',\"與\",\"二\",\n                             '為主','中','科','請','安全','注意','自身','國',\n                             '站','財物',\"或\",'可','的','近','路','中',\n                             '等','區',input$exclude.1,input$exclude.2,input$exclude.3\n                             ,input$exclude.4,input$exclude.5,input$exclude.6) })\n  \n  \n  word.plot <- reactive({ super_jieba_cloud(rawdata  = used.data(),\n                                            filters1 =  data.type1() , filters2= data.type2() , col1 = 3,  \n                                            excludeword =  excludes() ,\n                                            output_select = \"cloud\"  )  })\n  \n  output$f.word.cloud <- renderWordcloud2( { word.plot() }) \n  \n  word.table <- reactive({ w.table <- super_jieba_cloud(rawdata  = used.data(),\n                                                        filters1 =  data.type1() , filters2= data.type2() , col1 = 3,  \n                                                        excludeword =  excludes() ,\n                                                        output_select = \"file\"  )[1:10,]\n                           w.table <- t(w.table)\n                           rownames( w.table ) <- c(\"詞彙\",'出現次數')\n                           w.table  })\n  \n  output$f.data  <- renderTable({ word.table() } ,rownames = T, colnames = F)\n  output$f.txt   <- renderText({ paste(\"共有\",nrow(used.data()),'篇文章符合篩選條件')})\n  #data.type1 <- reactive \n\n  \n  \n  \n  #output$ddata <- renderTable({ head(  used.data() )})\n\n}\n\n# Run the application \nshinyApp(ui = ui, server = server)\n\n\n",
    "created" : 1497972142914.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3188026561",
    "id" : "528E6D1D",
    "lastKnownWriteTime" : 1497973051,
    "last_content_update" : 1497973051768,
    "path" : "C:/Users/PO HAO/Desktop/R code/ptt analysis/PTT_text-mining/Shiny/app.R",
    "project_path" : "Shiny/app.R",
    "properties" : {
        "source_window_id" : ""
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}